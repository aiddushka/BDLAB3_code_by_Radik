{% extends "base.html" %}

{% block title %}–î–æ–±–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑{% endblock %}

{% block content %}
<div class="card form-container">
    <h1 class="text-center">–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h1>

    {% if error %}
    <p class="text-error text-center">{{ error }}</p>
    {% endif %}

    <form method="POST">
        <!-- üîê CSRF —Ç–æ–∫–µ–Ω -->
        <input type="hidden" name="_csrf_token" value="{{ csrf_token() }}">

        <div class="form-group">
            <label class="form-label">–ú–∞—à–∏–Ω–∞ *</label>
            <select class="form-control" name="carid" required>
                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –º–∞—à–∏–Ω—É</option>
                {% for car in cars %}
                <option value="{{ car[0] }}">{{ car[1] }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label class="form-label">–°–æ—Ç—Ä—É–¥–Ω–∏–∫ *</label>
            <select class="form-control" name="employeeid" required>
                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</option>
                {% for employee in employees %}
                <option value="{{ employee[0] }}">{{ employee[1] }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label class="form-label">–î–∞—Ç–∞ –∑–∞–∫–∞–∑–∞</label>
            <input type="date" class="form-control" name="orderdate" value="{{ today }}">
        </div>

        <div class="form-group">
            <label class="form-label">–°—Ç–∞—Ç—É—Å</label>
            <select class="form-control" name="status">
                <option value="–ù–æ–≤—ã–π" selected>–ù–æ–≤—ã–π</option>
                <option value="–í —Ä–∞–±–æ—Ç–µ">–í —Ä–∞–±–æ—Ç–µ</option>
                <option value="–í—ã–ø–æ–ª–Ω–µ–Ω">–í—ã–ø–æ–ª–Ω–µ–Ω</option>
                <option value="–û—Ç–º–µ–Ω–µ–Ω">–û—Ç–º–µ–Ω–µ–Ω</option>
                <option value="–û–∂–∏–¥–∞–µ—Ç –∑–∞–ø—á–∞—Å—Ç–∏">–û–∂–∏–¥–∞–µ—Ç –∑–∞–ø—á–∞—Å—Ç–∏</option>
            </select>
        </div>

        <div class="form-group">
            <label class="form-label">–°—É–º–º–∞</label>
            <input type="number" step="0.01" min="0" class="form-control" name="totalamount" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É">
        </div>

        <button type="submit" class="btn btn-success" style="width: 100%">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </form>

    <div class="text-center mt-20">
        <a href="/table/–ó–∞–∫–∞–∑—ã" class="btn btn-dark">‚Üê –ù–∞–∑–∞–¥ –∫ –∑–∞–∫–∞–∑–∞–º</a>
    </div>
</div>

<script>
// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–µ–≥–æ–¥–Ω—è—à–Ω—é—é –¥–∞—Ç—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
document.addEventListener('DOMContentLoaded', function() {
    const today = new Date().toISOString().split('T')[0];
    const dateInput = document.querySelector('input[name="orderdate"]');
    if (dateInput && !dateInput.value) {
        dateInput.value = today;
    }
});
</script>
{% endblock %}
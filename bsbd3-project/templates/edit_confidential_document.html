{% extends "base.html" %}

{% block title %}–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç{% endblock %}

{% block content %}
<div class="card form-container">
    <a href="/table/–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã" class="btn btn-dark">‚Üê –ù–∞–∑–∞–¥ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º</a>

    <h1 class="text-center mb-20">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞</h1>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <p class="text-{{ category }} text-center">{{ message }}</p>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <form method="POST" enctype="multipart/form-data">
        <input type="hidden" name="_csrf_token" value="{{ csrf_token() }}">
        <input type="hidden" name="doc_id" value="{{ doc_id }}">

        <div class="form-group">
            <label class="form-label">ID –¥–æ–∫—É–º–µ–Ω—Ç–∞</label>
            <input type="text" class="form-control" value="{{ doc_id }}" readonly>
        </div>

        <div class="form-group">
            <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ *</label>
            <input type="text" class="form-control" name="doc_title"
                   value="{{ document.doctitle if document.doctitle else '' }}" maxlength="200" required>
        </div>

        <div class="form-group">
            <label class="form-label">–°–æ–∑–¥–∞—Ç–µ–ª—å</label>
            <input type="text" class="form-control" value="{{ document.creator_name if document.creator_name else '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ' }}" readonly>
        </div>

        <div class="form-group">
            <label class="form-label">–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è</label>
            <input type="text" class="form-control" value="{{ document.createddate if document.createddate else '' }}" readonly>
        </div>

        <div class="form-group">
            <label class="form-label">–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ</label>
            <textarea class="form-control" name="content" rows="10">{{ document.content if document.content else '' }}</textarea>
        </div>

        <div class="form-group">
            <label class="form-label">–£—Ä–æ–≤–µ–Ω—å –¥–æ—Å—Ç—É–ø–∞ *</label>
            <select class="form-control" name="access_level" required>
                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å –¥–æ—Å—Ç—É–ø–∞</option>
                <option value="Public" {% if document.accesslevel == 'Public' %}selected{% endif %}>Public - –û—Ç–∫—Ä—ã—Ç—ã–π</option>
                <option value="Internal" {% if document.accesslevel == 'Internal' %}selected{% endif %}>Internal - –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π</option>
                <option value="Confidential" {% if document.accesslevel == 'Confidential' %}selected{% endif %}>Confidential - –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π</option>
                <option value="Strictly" {% if document.accesslevel == 'Strictly' %}selected{% endif %}>Strictly - –°—Ç—Ä–æ–≥–æ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π</option>
            </select>
        </div>

        <div class="form-group">
            <label class="form-label">–¢–µ–∫—É—â–∏–π —Ñ–∞–π–ª</label>
            {% if document.filename and document.filename != 'None' and document.filename != 'null' %}
                <div class="current-file-info">
                    <p><strong>–ò–º—è —Ñ–∞–π–ª–∞:</strong> {{ document.filename }}</p>
                    <p><strong>–¢–∏–ø —Ñ–∞–π–ª–∞:</strong> {{ document.filetype }}</p>
                    <p><strong>–†–∞–∑–º–µ—Ä:</strong>
                        {% if document.filesize and document.filesize < 1024 %}
                            {{ document.filesize }} –ë
                        {% elif document.filesize and document.filesize < 1048576 %}
                            {{ (document.filesize / 1024)|round(1) }} –ö–ë
                        {% elif document.filesize %}
                            {{ (document.filesize / 1048576)|round(1) }} –ú–ë
                        {% else %}
                            –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ
                        {% endif %}
                    </p>
                    <p><strong>–î–∞—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è:</strong> {{ document.lastmodified if document.lastmodified else document.createddate }}</p>
                    <a href="/download/confidential_document/{{ doc_id }}" class="btn btn-sm btn-primary">
                        üì• –°–∫–∞—á–∞—Ç—å —Ç–µ–∫—É—â–∏–π —Ñ–∞–π–ª
                    </a>
                </div>
            {% else %}
                <p class="text-muted">–§–∞–π–ª –Ω–µ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω</p>
            {% endif %}
        </div>

        <div class="form-group">
            <label class="form-label">–ó–∞–º–µ–Ω–∏—Ç—å —Ñ–∞–π–ª (–º–∞–∫—Å–∏–º—É–º 16 –ú–ë)</label>
            <input type="file" class="form-control" name="confidential_file"
                   accept=".txt,.pdf,.doc,.docx,.xls,.xlsx,.jpg,.png">
            <small class="text-muted">–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Ñ–∞–π–ª</small>
        </div>

        <p class="text-muted">* –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è</p>

        <button type="submit" class="btn btn-success" style="width: 100%">
            üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
        </button>
    </form>
</div>
{% endblock %}